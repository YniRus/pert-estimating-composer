# PERT Estimating Composer

Проект для развертывания системы PERT Estimating с поддержкой SSL и поддоменов.

## Инструкция по настройке проекта на удаленном сервере

После импорта репозитория на удаленный виртуальный сервер, выполните следующие шаги для настройки и запуска проекта:

### 1. Настройка переменных окружения

1. Создайте файл `.env` в корневой директории проекта, скопировав пример из `.env.example`:

```bash
cp .env.example .env
```

2. Отредактируйте файл `.env`, указав реальные данные:
```
nano .env
```

### 2. Настройка DNS

1. Убедитесь, что ваш домен `pert-online.ru` и все поддомены `*.pert-online.ru` указывают на IP-адрес вашего сервера.
2. Проверьте настройки DNS:
```bash
dig pert-online.ru
dig <subdomain>.pert-online.ru  # Проверка wildcard записи
```

### 3. Получение SSL-сертификатов

```bash
# Запускаем скрипт получения SSL-сертификатов
./nginx/init-wildcard-acme.sh
```

### 4. Настройка переменных окружения сервисов

1. Создайте файлы переменных окружения для клиентского и серверного приложений:

```bash
# Копируем пример переменных окружения для клиентского приложения
cp pert-estimating-client/.env.example .env.client

# Копируем пример переменных окружения для серверного приложения
cp pert-estimating-server/.env.example .env.server
```

2. Отредактируйте файлы, указав реальные данные:
```bash
# Редактирование переменных окружения клиентского приложения
nano .env.client

# Редактирование переменных окружения серверного приложения
nano .env.server
```

### 5. Запуск проекта

```bash
# Запускаем проект с помощью скрипта nohup.sh для работы в фоновом режиме
./nohup.sh
```

### 6. Проверка работоспособности

1. Проверьте статус контейнеров:
```bash
docker-compose ps
```

2. Проверьте доступность сайта:
```bash
curl -I https://pert-online.ru
curl -I https://<subdomain>.pert-online.ru
```

3. Проверьте логи при необходимости:
```bash
docker-compose logs nginx
docker-compose logs acme
```

### 7. Дополнительные настройки

1. Настройте файрвол для разрешения портов 80 и 443:
```bash
ufw allow 80/tcp
ufw allow 443/tcp
```

2. Настройте список разрешенных клиентских доменов:
```bash
nano nginx/allowed_client_domains
```
